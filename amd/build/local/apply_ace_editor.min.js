define("filter_ace_inline/local/apply_ace_editor",["exports","filter_ace_inline/local/ui_parameters","filter_ace_inline/local/display_ui","filter_ace_inline/local/file_helpers"],(function(_exports,_ui_parameters,_display_ui,_file_helpers){function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.applyAceAndBuildUi=void 0;var _ref,ACE_MODE_MAP={c:"c_cpp",cpp:"c_cpp",js:"javascript",nodejs:"javascript","c#":"cs",octave:"matlab","c++":"c_cpp",python2:"python",python3:"python",markup:"html"},applyAceAndBuildUi=(_ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(root,isInteractive,config){var className,alternativeName,preElements,_iterator,_step,pre,uiParams,codeElements,_iterator2,_step2,code,_uiParams;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:className=isInteractive?"ace-interactive-code":"ace-highlight-code",alternativeName=isInteractive?"data-ace-interactive-code":"data-ace-highlight-code",preElements=root.getElementsByTagName("pre"),_iterator=_createForOfIteratorHelper(preElements);try{for(_iterator.s();!(_step=_iterator.n()).done;)"none"!==(pre=_step.value).style.display&&((uiParams=new _ui_parameters.UiParameters(pre)).extractUiParameters(isInteractive,config),(pre.classList.contains(className)||pre.hasAttribute(alternativeName))&&applyToPre(pre,isInteractive,uiParams))}catch(err){_iterator.e(err)}finally{_iterator.f()}codeElements=root.getElementsByTagName("code"),_iterator2=_createForOfIteratorHelper(codeElements);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)null!==(code=_step2.value).parentNode&&"none"!==code.parentNode.style.display&&(code.hasAttribute(alternativeName)||code.classList.contains(className))&&((_uiParams=new _ui_parameters.UiParameters(code)).extractUiParameters(isInteractive,config),applyToPre(code.parentNode,isInteractive,_uiParams))}catch(err){_iterator2.e(err)}finally{_iterator2.f()}case 8:case"end":return _context.stop()}}),_callee)}))),function(_x,_x2,_x3){return _ref.apply(this,arguments)});_exports.applyAceAndBuildUi=applyAceAndBuildUi;var _ref2,_ref3,applyToPre=(_ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(pre,isInteractive,uiParameters){var params,getCode;return regeneratorRuntime.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:(params=uiParameters.paramsMap)["file-upload-id"]&&(0,_file_helpers.setupFileHandler)(params["file-upload-id"]),params.hidden?isInteractive&&(getCode=function(){return pre.innerText},(0,_display_ui.addUi)(pre,getCode,uiParameters)):setUpAce(pre,uiParameters,isInteractive),pre.style.display="none";case 4:case"end":return _context2.stop()}}),_callee2)}))),function(_x4,_x5,_x6){return _ref2.apply(this,arguments)}),setUpAce=(_ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(pre,uiParameters,isInteractive){var params,darkMode,theme,showLineNumbers,aceLang,mode,text,lines,numLines,longestLine,editNode,width,aceConfig,editor,session,aceWidestLine,getCode;return regeneratorRuntime.wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:params=uiParameters.paramsMap,darkMode=params["dark-theme-mode"],theme=null,theme=2==darkMode||1==darkMode&&globalThis.matchMedia&&globalThis.matchMedia("(prefers-color-scheme: dark)").matches?"ace/theme/tomorrow_night":"ace/theme/textmate",showLineNumbers=!!params["start-line-number"],(aceLang=(aceLang=params["ace-lang"]?params["ace-lang"]:params.lang).toLowerCase())in ACE_MODE_MAP&&(aceLang=ACE_MODE_MAP[aceLang]),mode="ace/mode/"+aceLang,text=pre.textContent,lines=text.split("\n"),numLines=lines.length,longestLine=longest(lines),editNode=document.createElement("div"),width=pre.scrollWidth,editNode.style.margin="6px 0px 6px 0px",editNode.style.lineHeight="1.3",editNode.style.minWidth=width+"px",pre.after(editNode),aceConfig={newLineMode:"unix",mode:mode,minLines:Math.max(numLines,params["min-lines"]),maxLines:params["max-lines"],fontSize:params["font-size"],showLineNumbers:showLineNumbers,firstLineNumber:params["start-line-number"],showGutter:showLineNumbers,showPrintMargin:!1,autoScrollEditorIntoView:!0,highlightActiveLine:showLineNumbers},editor=globalThis.ace.edit(editNode,aceConfig),session=editor.getSession(),aceWidestLine=lineLength(editor.renderer,longestLine),editNode.style.minWidth=Math.ceil(Math.max(width,aceWidestLine))+"px",session.setValue(text),editor.setTheme(theme),null!==params.readonly&&editor.setReadOnly(!0),isInteractive?(getCode=function(){return editor.getSession().getValue()},(0,_display_ui.addUi)(editNode,getCode,uiParameters)):editor.renderer.$cursorLayer.element.style.display="none";case 28:case"end":return _context3.stop()}}),_callee3)}))),function(_x7,_x8,_x9){return _ref3.apply(this,arguments)}),lineLength=function(renderer,line){var chars=renderer.session.$getStringScreenWidth(line)[0];return Math.max(chars,2)*renderer.characterWidth+2*renderer.$padding+2+0},longest=function(lines){var _step3,longest="",_iterator3=_createForOfIteratorHelper(lines);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var line=_step3.value;line.length>longest.length&&(longest=line)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return longest}}));

//# sourceMappingURL=apply_ace_editor.min.js.map