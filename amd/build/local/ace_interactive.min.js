define("filter_ace_inline/local/ace_interactive",["exports","filter_ace_inline/local/utils","filter_ace_inline/local/file_helpers","filter_ace_inline/local/repository"],(function(_exports,_utils,_file_helpers,_repository){function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.handleButtonClick=_exports.executeCode=void 0;var _ref,handleButtonClick=(_ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(outputDisplayArea,code,uiParameters){var errorText,params,mapFunc,sandboxParams,text;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(cleanOutput(outputDisplayArea),errorText="",params=uiParameters.paramsMap,outputDisplayArea.style.display="",uiParameters.setExecLang(params.lang),uiParameters.setHtmlOutput(params["html-output"]),!((mapFunc=params["code-mapper"])in globalThis)){_context.next=11;break}code=globalThis[mapFunc](code),_context.next=15;break;case 11:if(null===mapFunc){_context.next=15;break}return _context.next=14,(0,_utils.getLangString)("error_script_unknown");case 14:errorText=_context.sent;case 15:return code=params.prefix+code+params.suffix,uiParameters.setStdin(),_context.t0=uiParameters,_context.next=20,(0,_file_helpers.getFiles)(uiParameters);case 20:_context.t1=_context.sent,_context.t0.setFiles.call(_context.t0,_context.t1),"markup"!==params.lang&&"html"!==params.lang||(outputDisplayArea.setAttribute("class","filter-ace-inline-output-html"),uiParameters.setHtmlOutput(!0),uiParameters.setExecLang("python3"),code="print('''"+code+"''')"),_context.prev=23,(sandboxParams=JSON.parse(params.params)).hasOwnProperty("runargs")?sandboxParams.runargs=sandboxParams.runargs.concat(uiParameters.sandboxParams):sandboxParams.runargs=uiParameters.sandboxParams,uiParameters.setRunParams(JSON.stringify(sandboxParams)),_context.next=34;break;case 29:return _context.prev=29,_context.t2=_context.catch(23),_context.next=33,(0,_utils.getLangString)("error_json_params");case 33:errorText=_context.sent;case 34:if(null!==uiParameters.stdin&&"bad_id"!==uiParameters.files){_context.next=38;break}return _context.next=37,(0,_utils.getLangString)("error_element_unknown");case 37:errorText=_context.sent;case 38:if(""===errorText){_context.next=49;break}return _context.next=41,(0,_utils.getLangString)("error_user_params");case 41:return _context.t3=_context.sent,_context.t4="*** "+_context.t3,_context.t5=_context.t4+" ***\n",_context.t6=errorText,text=_context.t5+_context.t6,outputDisplayArea.setAttribute("class","filter-ace-inline-output-user"),outputDisplayArea.children.item(0).innerHTML=(0,_utils.escapeHtml)(text),_context.abrupt("return",null);case 49:return _context.abrupt("return",code);case 50:case"end":return _context.stop()}}),_callee,null,[[23,29]])}))),function(_x,_x2,_x3){return _ref.apply(this,arguments)});_exports.handleButtonClick=handleButtonClick;var _ref2,executeCode=(_ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(outputDisplayArea,code,uiParameters){return regeneratorRuntime.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,(0,_repository.processCode)(code,uiParameters).then((function(responseJson){return displaySuccess(responseJson,outputDisplayArea,uiParameters),null})).catch((function(error){cleanOutput(outputDisplayArea),outputDisplayArea.setAttribute("class","filter-ace-inline-output-user"),displayTextOutput(error.message,"error_user_params",outputDisplayArea)}));case 2:case"end":return _context2.stop()}}),_callee2)}))),function(_x4,_x5,_x6){return _ref2.apply(this,arguments)});_exports.executeCode=executeCode;var _ref3,displaySuccess=function(responseJson,outputDisplayArea,uiParameters){var text="",langString="",params=uiParameters.paramsMap,htmlOutput=null!==uiParameters.htmlOutput,maxLen=params["max-output-length"];cleanOutput(outputDisplayArea);var response=JSON.parse(responseJson),error=(0,_utils.diagnose)(response);if(""===error)if(htmlOutput&&15===response.result){outputDisplayArea.setAttribute("class","filter-ace-inline-output-html");var html=(0,_utils.createComponent)("div",["filter-ace-inline-html"],{});html.innerHTML=response.output,outputDisplayArea.after(html)}else text+=(0,_utils.combinedOutput)(response,maxLen),15!==response.result&&outputDisplayArea.setAttribute("class","filter-ace-inline-output-error");else{outputDisplayArea.setAttribute("class","filter-ace-inline-output-error");var extra=0==response.error?(0,_utils.combinedOutput)(response,maxLen):"";"error_unknown_runtime"===error&&(extra+=response.error?"(Sandbox error code "+response.error+")":"(Run result: "+response.result+")"),langString+=error,text+=extra}displayTextOutput(text,langString,outputDisplayArea)},displayTextOutput=(_ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(text,langString,outputDisplayArea){return regeneratorRuntime.wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(""===langString){_context3.next=8;break}return _context3.next=3,(0,_utils.getLangString)(langString);case 3:_context3.t0=_context3.sent,_context3.t1="*** "+_context3.t0,_context3.t2=_context3.t1+" ***\n",_context3.t3=text,text=_context3.t2+_context3.t3;case 8:outputDisplayArea.children.item(0).innerHTML=(0,_utils.escapeHtml)(text);case 9:case"end":return _context3.stop()}}),_callee3)}))),function(_x7,_x8,_x9){return _ref3.apply(this,arguments)}),cleanOutput=function(outputDisplayArea){outputDisplayArea.children.item(0).innerHTML="";var potentialHtml=outputDisplayArea.nextElementSibling;null!==potentialHtml&&"filter-ace-inline-html"===potentialHtml.className&&outputDisplayArea.parentNode.removeChild(outputDisplayArea.nextSibling),outputDisplayArea.setAttribute("class","filter-ace-inline-output-display")}}));

//# sourceMappingURL=ace_interactive.min.js.map